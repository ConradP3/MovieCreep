[[extend 'layout.html']]
<div class="section">
  <div class="container">
    <div class='is-pulled-right'>
      <a class="button is-success" href="[[=URL('add_movie')]]">
        <span class="icon"><i class="fa fa-plus"></i></span>
        <span>Add New Movie</span>
      </a>
    </div>
    <h1 class="title">Feed</h1>

    <div class="columns is-mobile">
      [[for row in reversed(rows):]]

      <div class="container block">
        <div class="box has-background-white-ter box-shadow">
          <img src="[[=row.link]]" width="142">
          <div class="tooltip"> <i class='fa fa-exclamation-circle'></i>
            <span class="tooltiptext is-pulled-left"> 
              <!-- plot, runtime, releasedate, rating, imbdbrating, genre -->
              <p><B>[[=row.movie_title]]</B></p>
              <p><B>Rated: [[=row.rating]]</B></p>
              <p><B>Released:[[=row.releasedate]]</B></p>
              <p><B>Runtime: [[=row.runtime]]</B></p>
              <p><B>Genre: [[=row.genre]]</B></p>
              <p><B>[[=row.plot]]</B></p>
            </span>
          </div>
          <p><B>[[=row.movie_title]]</B></p>
          [[if row.watch_list_watched: ]]
            <p>Seen by [[=row.watch_list_user_email]]</p>

          [[else:]]
            <p>[[=row.watch_list_user_email]] Hasn't seen this</p>
          [[pass]]
          
          <p>[[=row.watch_list_date]]</p>
            <span @mouseout="stars_out(img._idx)">
              <span @mouseover="stars_over(img._idx, star_idx)"
                    @click="set_stars(img._idx, star_idx)"
                    v-for="star_idx in [1, 2, 3, 4, 5]">
                <i v-if="star_idx <= img.num_stars_display" class="fa fa-star"></i>
                <i v-if="star_idx > img.num_stars_display" class="fa fa-star-o"></i>
              </span>
            </span>
          [[x=row.watch_list_user_email]]
          [[y=user_email]]
          [[if x == y:]]
              <a class="button is-pulled-right" href="[[=URL('edit_movie', row.id, signer=url_signer)]]">
                <span class="icon"><i class="fa fa-fw fa-pencil"></i></span> <span>Edit</span>
              </a>

              <a class="button is-pulled-right" href="[[=URL('delete_movie', row.id, signer=url_signer)]]">
                <span class="icon"><i class="fa fa-fw fa-trash"></i></span>
              </a>

              <br />
              <br />
              
              <a class="is-pulled-right">
                <p>[[=row.watch_list_time_stamp]]</p>
              </a>
              <br />
          [[pass]]
          <br />
          <br />
          [[if x !=y :]]
            <a class="is-pulled-right">
              <p>[[=row.watch_list_time_stamp]]</p>
            </a>
          [[pass]]
          <br />

        </div>

      [[pass]]

    </div>

    <!-- <table class="table is-striped is-fullwidth">
        <tr>
          <th>Movie Title</th>
          <th>Watched</th>
          <th>User</th>
        </tr>
        [[for row in rows:]]
        <tr>
          <td>[[=row.movie_title]]</td>
          <td>[[=row.watch_list_watched]]</td>
          <td>[[=row.watch_list_user_email]]</td>

        </tr>
        [[pass]]
      </table> -->
  </div>




</div>



[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let add_movie_url = "[[=XML(add_movie_url)]]";
  let get_rating_url = "[[=XML(get_rating_url)]]";
  let set_rating_url = "[[=XML(set_rating_url)]]";
</script>
<script src="js/index.js"></script>
[[end]]


<!-- https://www.w3schools.com/howto/howto_css_tooltip.asp -->
<style>
  /* Tooltip container */
  .tooltip {
    position: relative;
    display: inline-block;
    border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
  }
  
  /* Tooltip text */
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 400px;
    background-color: #555;
    color: #fff;
    text-align: center;
    padding: 5px 0;
    border-radius: 6px;
  
    /* Position the tooltip text */
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
  
    /* Fade in tooltip */
    opacity: 0;
    transition: opacity 0.3s;
  }
  
  /* Tooltip arrow */
  .tooltip .tooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #555 transparent transparent transparent;
  }
  
  /* Show the tooltip text when you mouse over the tooltip container */
  .tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
  }
  </style>